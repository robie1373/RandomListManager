<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Random List Manager - Modern tool for RPG dice tables, legends, and weighted random selection">
    <meta name="theme-color" content="#0284c7">
    <title>Random List Manager</title>
    <link rel="stylesheet" href="src/styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="dark-mode">
    <div id="app">
        <!-- Navigation Header -->
        <header class="nav-header">
            <button id="toolsBtn" class="tools-btn" aria-label="Tools menu">‚öôÔ∏è Tools</button>
        </header>
        
        <!-- Tools Menu Dropdown -->
        <div id="toolsMenu" class="tools-menu hidden">
            <div class="tools-menu-section">
                <label class="tools-menu-item">
                    <input type="checkbox" id="darkModeToggle" checked>
                    <span>Dark Mode</span>
                </label>
            </div>
            <div class="tools-menu-divider"></div>
            <div class="tools-menu-section">
                <button class="tools-menu-btn" id="exportCSV">üìÑ Export CSV</button>
                <button class="tools-menu-btn" id="exportJSON">üìã Export JSON</button>
                <button class="tools-menu-btn" id="exportXLSX">üìä Export XLSX</button>
                <button class="tools-menu-btn" id="exportAllTabs">üì¶ Export All Tabs (JSON)</button>
            </div>
            <div class="tools-menu-divider"></div>
            <div class="tools-menu-section">
                <button class="tools-menu-btn" id="importData">üì• Import Data</button>
                <input type="file" id="importFileInput" accept=".csv,.json,.xlsx" style="display: none;">
            </div>
            <div class="tools-menu-divider"></div>
            <div class="tools-menu-section">
                <button class="tools-menu-btn" id="deleteTab">üóëÔ∏è Delete Current Tab</button>
            </div>
            <div class="tools-menu-divider"></div>
            <div class="tools-menu-section">
                <button class="tools-menu-btn" id="aboutBtn">‚ÑπÔ∏è About</button>
            </div>
            <div class="tools-menu-divider"></div>
            <div class="tools-menu-warning">
                <strong>‚ö†Ô∏è Data Storage:</strong> Your data is stored locally in your browser. It will be lost if you clear browser data or switch devices. <strong>Regularly export your data</strong> to prevent loss.
            </div>
        </div>

        <!-- About Modal -->
        <div id="aboutModal" class="modal hidden">
            <div class="modal-content">
                <button id="closeAbout" class="modal-close">‚úï</button>
                <h2>About Random List Manager</h2>
                <p>The Random List Manager is a versatile tool for game masters, writers, and creative professionals who need quick access to randomized content. Whether you're generating NPCs, rolling for encounters, or selecting story beats, this application provides a lightweight, browser-based solution.</p>
                
                <h3>Features</h3>
                <ul>
                    <li><strong>Multiple Tabs:</strong> Organize different random lists into separate tabs (Items, Weapons, Encounters, etc.)</li>
                    <li><strong>Weighted Rolls:</strong> Assign weight values to control the probability of each result</li>
                    <li><strong>Tag Filtering:</strong> Filter results using tags with OR/AND logic</li>
                    <li><strong>Roll History:</strong> Track all rolls made on each tab with timestamps</li>
                    <li><strong>Import/Export:</strong> Save and share your lists in CSV, JSON, or XLSX format</li>
                    <li><strong>Dark Mode:</strong> Easy on the eyes for late-night gaming sessions</li>
                </ul>
                
                <h3>How It Works</h3>
                <p>All your data is stored locally in your browser using localStorage. This means your lists persist between sessions, but they are only available on this browser and device. To ensure you don't lose your data, regularly export your lists using the "Export All Tabs" feature.</p>
                
                <h3>Tips & Tricks</h3>
                <ul>
                    <li>Use weights to make rare encounters truly rare‚Äîa weight of 1 vs 100 creates significant probability differences</li>
                    <li>Combine tags with AND logic to create nuanced filters (e.g., "magic" AND "rare" finds only magical rare items)</li>
                    <li>Export your data after major updates to maintain backups across devices</li>
                    <li>Use the roll log to track what you've already rolled and avoid repetition</li>
                </ul>
                
                <p style="margin-top: 20px; font-style: italic; color: #999;">
                    <strong>Version:</strong> 1.0.0 | Built with vanilla JavaScript | Data stays local, never shared
                </p>
            </div>
        </div>
        
        <!-- Inline prompts -->
        <div id="promptContainer" class="prompt-container hidden" role="alert">
            <div id="promptMessage" class="prompt-message"></div>
            <div class="prompt-actions">
                <button id="promptPrimary" class="prompt-btn primary"></button>
                <button id="promptSecondary" class="prompt-btn"></button>
                <button id="promptCancel" class="prompt-btn ghost">Cancel</button>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <nav class="tabs">
            <!-- Tabs dynamically rendered by JavaScript -->
        </nav>
        
        <!-- Main Content -->
        <main class="main-content">
        
        <!-- Input and Add Button -->
        <div class="input-section" style="display: none;">
            <input id="simpleInput" type="text" placeholder="Enter item name and dice (e.g., Potion 2d4)">
            <button class="btn-add">Add Item</button>
        </div>
        
        <!-- Results Display -->
        <div id="resultWrapper">
            <div id="result">Ready to roll...</div>
            <button id="copyBtn" class="hidden">üìã Copy</button>
            <button id="rollBtn" class="btn-random">üé≤ Roll on Table</button>
        </div>
        
        <!-- Roll Log -->
        <div id="rollLogContainer" class="roll-log-container collapsed">
            <div class="roll-log-header">
                <button id="rollLogToggle" class="roll-log-toggle">‚ñ∂ Show Roll Log</button>
                <button id="clearRollLog" class="roll-log-clear">üóëÔ∏è Clear</button>
            </div>
            <div id="rollLogList" class="roll-log-list"></div>
        </div>
        
        <!-- Tag Cloud -->
        <div id="tagCloudContainer">
            <div class="tag-cloud-header">
                <span class="tag-cloud-title">Filter by Tags:</span>
                <div class="tag-match-mode">
                    <label>
                        <input type="radio" name="tagMatchMode" value="OR" checked>
                        <span>OR (any)</span>
                    </label>
                    <label>
                        <input type="radio" name="tagMatchMode" value="AND">
                        <span>AND (all)</span>
                    </label>
                </div>
            </div>
            <div id="tagCloud" class="tag-cloud"></div>
        </div>
        
        <!-- Tables Container -->
        <div class="tables-container">
            <!-- Items Table -->
            <div class="main-table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th id="tableNameHeader">Name</th>
                            <th>Tags</th>
                            <th>Reference</th>
                            <th>Weight</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
                <div class="table-hint">Tags autocomplete: type to see existing tags, use ‚Üë/‚Üì to highlight, Tab to accept.</div>
            </div>
            
            <!-- Legend Table -->
            <div class="legend-wrapper">
                <h3 class="legend-title">Legend</h3>
                <table class="legend-table">
                    <thead>
                        <tr>
                            <th>Acronym</th>
                            <th>Full Name</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="legendTableBody">
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Help Text -->
        <div class="help-text">
            <p><strong>Tag Filtering Tips:</strong></p>
            <ul>
                <li><strong>OR mode:</strong> Shows items that have ANY of the selected tags.</li>
                <li><strong>AND mode:</strong> Shows items that have ALL of the selected tags.</li>
                <li><strong>Pro tip:</strong> Use difficulty level tags (e.g., "easy", "medium", "hard") combined with AND logic to ensure roll results match your party's level. For example, select both "potion" AND "easy" to get only easy-difficulty potions.</li>
            </ul>
        </div>
        </main>
    </div>
        
    <script type="module" src="src/ui.js"></script>
</body>
</html>