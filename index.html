<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="src/styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="dark-mode">
    <div id="app">
        <!-- Navigation Context and Tools Menu -->
        <div class="nav-header">
            <div id="navContext">items</div>
            <button id="toolsBtn" class="tools-btn">‚öôÔ∏è Tools</button>
        </div>
        
        <!-- Tools Menu Dropdown -->
        <div id="toolsMenu" class="tools-menu hidden">
            <div class="tools-menu-section">
                <label class="tools-menu-item">
                    <input type="checkbox" id="darkModeToggle" checked>
                    <span>Dark Mode</span>
                </label>
            </div>
            <div class="tools-menu-divider"></div>
            <div class="tools-menu-section">
                <button class="tools-menu-btn" id="exportCSV">üìÑ Export CSV</button>
                <button class="tools-menu-btn" id="exportJSON">üìã Export JSON</button>
                <button class="tools-menu-btn" id="exportXLSX">üìä Export XLSX</button>
                <button class="tools-menu-btn" id="exportAllTabs">üì¶ Export All Tabs (JSON)</button>
            </div>
            <div class="tools-menu-divider"></div>
            <div class="tools-menu-section">
                <button class="tools-menu-btn" id="importData">üì• Import Data</button>
                <input type="file" id="importFileInput" accept=".csv,.json,.xlsx" style="display: none;">
            </div>
            <div class="tools-menu-divider"></div>
            <div class="tools-menu-section">
                <button class="tools-menu-btn" id="deleteTab">üóëÔ∏è Delete Current Tab</button>
            </div>
        </div>

        <!-- Inline prompts (no popups) -->
        <div id="promptContainer" class="prompt-container hidden">
            <div id="promptMessage" class="prompt-message"></div>
            <div class="prompt-actions">
                <button id="promptPrimary" class="prompt-btn primary"></button>
                <button id="promptSecondary" class="prompt-btn"></button>
                <button id="promptCancel" class="prompt-btn ghost">Cancel</button>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div class="tabs">
            <!-- Tabs will be dynamically rendered by JavaScript -->
        </div>
        
        <!-- Input and Add Button -->
        <div class="input-section" style="display: none;">
            <input id="simpleInput" type="text" placeholder="Enter item name and dice (e.g., Potion 2d4)">
            <button class="btn-add">Add Item</button>
        </div>
        
        <!-- Results Display -->
        <div id="resultWrapper">
            <div id="result">Ready to roll...</div>
            <button id="copyBtn" class="hidden">üìã Copy</button>
        </div>
        <button id="rollBtn" class="btn-random">üé≤ Roll on Table</button>
        
        <!-- Roll Log -->
        <div id="rollLogContainer" class="roll-log-container collapsed">
            <div class="roll-log-header">
                <button id="rollLogToggle" class="roll-log-toggle">‚ñ∂ Show Roll Log</button>
                <button id="clearRollLog" class="roll-log-clear">üóëÔ∏è Clear</button>
            </div>
            <div id="rollLogList" class="roll-log-list"></div>
        </div>
        
        <!-- Tag Cloud -->
        <div id="tagCloudContainer">
            <div class="tag-cloud-header">
                <span class="tag-cloud-title">Filter by Tags:</span>
                <div class="tag-match-mode">
                    <label>
                        <input type="radio" name="tagMatchMode" value="OR" checked>
                        <span>OR (any)</span>
                    </label>
                    <label>
                        <input type="radio" name="tagMatchMode" value="AND">
                        <span>AND (all)</span>
                    </label>
                </div>
            </div>
            <div id="tagCloud" class="tag-cloud"></div>
        </div>
        
        <!-- Tables Container -->
        <div class="tables-container">
            <!-- Items Table -->
            <div class="main-table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th id="tableNameHeader">Name</th>
                            <th>Tags</th>
                            <th>Reference</th>
                            <th>Weight</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
                <div class="table-hint">Tags autocomplete: type to see existing tags, use ‚Üë/‚Üì to highlight, Tab to accept.</div>
            </div>
            
            <!-- Legend Table -->
            <div class="legend-wrapper">
                <h3 class="legend-title">Legend</h3>
                <table class="legend-table">
                    <thead>
                        <tr>
                            <th>Acronym</th>
                            <th>Full Name</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="legendTableBody">
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Help Text -->
        <div class="help-text">
            <p><strong>Tag Filtering Tips:</strong></p>
            <ul>
                <li><strong>OR mode:</strong> Shows items that have ANY of the selected tags.</li>
                <li><strong>AND mode:</strong> Shows items that have ALL of the selected tags.</li>
                <li><strong>Pro tip:</strong> Use difficulty level tags (e.g., "easy", "medium", "hard") combined with AND logic to ensure roll results match your party's level. For example, select both "potion" AND "easy" to get only easy-difficulty potions.</li>
            </ul>
        </div>
    </div>
        
    <script type="module" src="src/ui.js"></script>
</body>
</html>